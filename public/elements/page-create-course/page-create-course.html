<link rel="import" href="../part-jumbotron/part-jumbotron.html">
<link rel="import" href="../style-page/style-page.html">
<link rel="import" href="part-create-course.html">
<link rel="import" href="../../components/api-model/api-model.html">
<link rel="import" href="part-create-course-save.html">
<link rel="import" href="part-upload-image.html">


<dom-module id="page-create-course">
  <template>
    <style include="style-page"></style>
    <api-model-create id="put" collection="courses" data="{{course}}" response="{{response}}" on-response="on_response"></api-model-create>
    
    <layout-client>
      <part-jumbotron class="jumbotron">
        <h1>Create course</h1>
      </part-jumbotron>
      <div class="container">
        <part-create-course-save on-try-save="on_try_save"></part-create-course-save>
        
        <part-create-course on-create-course="on_create_course" course="{{course}}"></part-create-course>

         <part-upload-image on-response="on_upload"></part-upload-image>
      </div>
    </layout-client>
      
  </template>
</dom-module>

<script>
  Polymer({

    is: 'page-create-course',

    properties: {
      course: {
        type: Object,
        value: function () { return {}; }
      }
    },
    on_try_save:function(event){
      event.stopPropagation();
      this.$.put.send();
    },

    on_response:function(event){
      page('/courses/'+ this.response.id +'/lecture/new');
    },

    on_upload:function(event){
      var url = event.detail.split("?")[0];
      this.course.url=url;
    }

  });
</script>