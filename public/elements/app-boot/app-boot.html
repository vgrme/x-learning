<link rel="import" href="../../components/app-container/app-container.html">
<link rel="import" href="../behavior-router/behavior-router.html">
<link rel="import" href="../page-404/page-404.html">
<link rel="import" href="../page-category/page-category.html">
<link rel="import" href="../page-course/page-course.html">
<link rel="import" href="../page-home/page-home.html">
<link rel="import" href="../page-lecture/page-lecture.html">
<link rel="import" href="../page-upload/page-upload.html">

<dom-module id="app-boot">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <app-container id="app"></app-container>

  </template>
</dom-module>

<script>
  Polymer({

    is: 'app-boot',

    behaviors: [
      Polymer.BehaviorRouter
    ],

    '/': function (context) {
      context.page = 'page-home';
      this.open(context);
    },

    '/admin/upload': function (context) {
      context.page = 'page-upload';
      this.open(context);
    },

    '/courses/:course_id': function (context) {
      this.get_model({
        collection: 'courses',
        modelId: context.params.course_id,
        include: ['lectures']
      })
      .then(function (model) {
        context.page = 'page-course';
        context.data = {};
        context.data.course = model;
        this.open(context);
      }.bind(this))
      .catch(function (error) {
        this.redirect('/404');
      }.bind(this));
    },

    '/courses/:course_id/lectures/:lecture_id': function (context) {
      context.page = 'page-lecture';
      this.open(context);
    },

    '/categories/:category_id': function (context) {
      context.page = 'page-category';
      this.open(context);
    },

    '/404': function (context) {
      context.page = 'page-404';
      this.open(context);      
    }

  });
</script>